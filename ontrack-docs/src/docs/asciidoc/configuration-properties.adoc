[[configuration-properties]]
=== Configuration properties

Ontrack uses the Spring Boot mechanism for its configuration.
See the <<configuration,documentation>> on how to set those properties in your Ontrack installation.

All http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#common-application-properties[Spring Boot properties]
are available for configuration.

Additionally, Ontrack defines the following ones.

TIP: The names of the configuration properties are given for a `.properties`
file format but you can configure them in YAML of course.
They can also be provided as system properties or environment variables.
See the
http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-properties-and-configuration[Spring Boot documentation]
for more details.

WARNING: This sample file is meant as a guide only.
Do *not* copy/paste the entire content into your application; rather pick only the properties that you need.

TIP: When applicable, the default value is mentioned.

[source,properties]
----
# ======================================================
# Ontrack properties
# ======================================================

# Maximum number of days to keep the log entries
ontrack.config.application-log-retention-days = 7

# Maximum number of errors to display as notification in the GUI
ontrack.config.application-log-info-max = 10

# Directory which contains all the working files of Ontrack
# It is usually set by the installation
ontrack.config.application-working-dir = work/files

# Maximum number of builds which can be returned by a build filter
# Any number above is truncated down to this value
ontrack.config.build-filter-count-max = 200

# Testing the configurations of external configurations
# Used only for internal testing, to disable the checks
# when creating external configurations
ontrack.config.configuration-test = true

# Activation of the provided labels collection job
ontrack.config.job-label-provider-enabled = false

# Number of threads to use to run the background jobs
ontrack.config.jobs.pool-size = 10

# Interval (in minutes) between each refresh of the job list
ontrack.config.jobs.orchestration = 2

# Set to true to not start any job at application startup
# The administrator can restore the scheduling jobs manually
ontrack.config.jobs.paused-at-startup = false

# Enabling the scattering of jobs
# When several jobs have the same schedule, this can create a peak of activity,
# potentially harmful for the performances of the application
# Enabling scattering allows jobs to be scheduled with an additional delay, computed
# as a fraction of the period.
ontrack.config.jobs.scattering = false

# Scattering ratio. Maximum fraction of the period to take into account for the
# scattering. For example, setting 0.5 would not add a dealy greater than half
# the period of the job. Setting 0 would actually disable the scattering altogether.
ontrack.config.jobs.scattering-ratio = 1.0

# Global timeout for all jobs
# Any job running longer than this time will be forcibly stopped
# It defaults to 4 hours
ontrack.config.jobs.timeout = 4h

# Amount of time to wait between two controls of the job timeouts
ontrack.config.jobs.timeout-controller-interval = 15m

# Confidential store for the encryption keys
ontrack.config.key-store = file

# Cache configuration
# Caffeine spec strings per cache type
# See http://static.javadoc.io/com.github.ben-manes.caffeine/caffeine/2.6.0/com/github/benmanes/caffeine/cache/CaffeineSpec.html
# For example, for the `properties` cache:
ontrack.config.cache.specs.properties = maximumSize=1000,expireAfterWrite=1d,recordStats

#################################
# Search configuration properties
#################################

# By default, indexation is ElasticSearch is done after some
# time after the index has been requested. The flag below
# forces the index to be refreshed immediately.
# This SHOULD NOT be used in production but is very useful
# when testing Ontrack search capabilities
ontrack.config.search.index.immediate = false

# When performing full indexation, the indexation is performed
# by batch. The parameter below allows to set the size
# of this batch processing.
# Note: this is a default batch size. Custom indexers can
# override it.
ontrack.config.search.index.batch = 1000

# When performing full indexation, the indexation is performed
# by batch. The parameter below allows to generate additional
# logging when indexing actions are actually taken.
ontrack.config.search.index.logging = false

# When performing full indexation, the indexation is performed
# by batch. The parameter below allows to generate additional
# logging for all actions on Git issues
# Note: if set to `true` this generates an awful lot if information
# at DEBUG level.
ontrack.config.search.index.tracing = false
----

[[configuration-properties-git]]
==== Git Configuration properties

[source,properties]
----
# Timeout in seconds for remote operations to start (like fetch & clone)
# Leave 0 to use the default system value. Set to 60 seconds by default.
# This timeout is used for the connection part, not the
# total duration of the operation.
# For the completion timeout, see operation-timeout below
ontrack.config.extension.git.remote.timeout = 60s

# Timeout (by default in minutes) for a given remote
# operation to complete (like fetch & clone)
# Set to 10 minutes by default.
ontrack.config.extension.git.remote.operation-timeout = 10m

# Number of retries to run when there is a timeout.
# Set to 0 for no retry.
ontrack.config.extension.git.remote.retries = 3

# Interval between retries (by default in seconds
# and set to 30 seconds by default).
ontrack.config.extension.git.remote.interval = 30s

# Enabling pull requests
ontrack.config.extension.git.pull-requests.enabled = true

# Caching enabled for pull requests
ontrack.config.extension.git.pull-requests.cache.enabled = true

# Caching duration for pull requests
ontrack.config.extension.git.pull-requests.cache.duration = 30m

# Auto cleanup of pull requests
ontrack.config.extension.git.pull-requests.cleanup.enabled = true

# Days before disabling
ontrack.config.extension.git.pull-requests.cleanup.disabling = 1

# Days before deleting
ontrack.config.extension.git.pull-requests.cleanup.deleting = 7

# Timeout for the Git indexations
ontrack.config.extension.git.indexation.timeout = 30m
----

[[configuration-properties-github]]
==== GitHub Configuration properties

[source,properties]
----
# Set to `true` to disable the signature checks (OK for testing, NOT for production)
ontrack.extension.github.ingestion.hook.signature.disabled = false

# By default, true, using a RabbitMQ engine
# Set to false to use a direct processing (synchronous)
ontrack.extension.github.ingestion.processing.async = true

# Declaring other queues for repositories
# Regex for the repository owner, null for match all
# ontrack.extension.github.ingestion.processing.repositories.very-active.owner=
# Regex for the repository name, null for match all
# ontrack.extension.github.ingestion.processing.repositories.very-active.repository = very-active-repository
----

[[configuration-properties-elastic]]
==== Elastic Configuration properties

[source,properties]
----
# Is the export of metrics to Elastic enabled?
ontrack.extension.elastic.metrics.enabled = false

# Must we trace the behaviour of the export of the metrics in the logs?
ontrack.extension.elastic.metrics.debug = false

# Defines where the Elastic metrics should be sent.
# Possible values are
# MAIN - When this option is selected, the ES instance used
# by Ontrack for the regular search will be used.
# CUSTOM -When this option is selected, the ES instance defined
# by the metrics properties will be used.
ontrack.extension.elastic.metrics.target = MAIN

# Name of the index to contains all Ontrack metrics
ontrack.extension.elastic.metrics.index.name = ontrack_metrics

# Flag to enable immediate re-indexation after items are added
# into the index (used mostly for testing. It should not be
# used in production.
# If set to true, this overrides the asynchronous processing
# of the metrics
ontrack.extension.elastic.metrics.index.immediate = false

# Maximum capacity for the queue.
# If the queue exceeds this capacity, new events will be on hold
ontrack.extension.elastic.metrics.queue.capacity = 1024

# Bulk update capacity.
# When the number of metrics reaches this amount, the metrics
# are sent to Elastic.
ontrack.extension.elastic.metrics.queue.buffer = 512

# Every such interval, the current buffer of metrics is flushed
# to Elastic.
ontrack.extension.elastic.metrics.queue.flushing = 1m

# If the `target` property is set to `CUSTOM`, the following properties
# will be used to setup the Elastic instance to use for the export
# of the metrics.
ontrack.extension.elastic.metrics.custom.uris = http://localhost:9200
#ontrack.extension.elastic.metrics.custom.username =
#ontrack.extension.elastic.metrics.custom.password =
# Other properties are available.
# See https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/autoconfigure/elasticsearch/ElasticsearchProperties.html
----
